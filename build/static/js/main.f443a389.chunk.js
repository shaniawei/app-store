(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{33:function(e,t,a){e.exports=a(45)},38:function(e,t,a){},45:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),s=a.n(c),i=(a(38),a(1)),o=a(2),l=a(4),u=a(3),m=a(5),p=a(17),d=a(18),b=a(14),h=a(9),f=a.n(h),g=a(16),v=a(15),j=a(13),O=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"loading_box"},r.a.createElement("div",{className:"loading_icon"}))}}]),t}(n.PureComponent),y=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"home_search_box"},r.a.createElement("div",{className:"home_search"},r.a.createElement(p.b,{to:"/search"},r.a.createElement("img",{className:"icon",src:"http://127.0.0.1:3010/images/search.svg"}),r.a.createElement("div",{className:"title"},"\u641c\u7d22"))))}}]),t}(n.PureComponent),E=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){console.log("this",this.props);var e=this.props.recommend.feed.entry;return r.a.createElement("div",{className:"recommend_wrap"},r.a.createElement("div",{className:"recommend_box"},r.a.createElement("div",{className:"title"},"\u63a8\u8350"),r.a.createElement("div",{className:"items"},e.map(function(e,t){return r.a.createElement("div",{className:t?"item_box":"item_box first",key:e.id.attributes["im:id"]},r.a.createElement("img",{src:e["im:image"][0].label,className:"logo"}),r.a.createElement("div",{className:"txt tow_row_ellipsis"},e.title.label),r.a.createElement("div",{className:"category ellipsis"},e.category.attributes.label))}))))}}]),t}(n.PureComponent),N=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){console.log("this",this.props);var e=this.props.appList.feed.entry;return r.a.createElement("div",{className:"rank_wrap"},r.a.createElement("div",{className:"rank_box"},e.map(function(e,t){return r.a.createElement("div",{className:t?"item_box":"item_box first",key:t},r.a.createElement("div",{className:"num"},t+1),r.a.createElement("img",{className:t%2==0?"icon_radius icon":"icon_circle icon",src:e["im:image"][0].label}),r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"title ellipsis"},e.title.label),r.a.createElement("div",{className:"category ellipsis"},e.category.attributes.label),r.a.createElement("div",{className:"star ellipsis"},"\u6ca1\u6709\u770b\u5230\u8bc4\u5206\u6570\u636e")))})))}}]),t}(n.PureComponent),x=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"line"})}}]),t}(n.PureComponent),L="getAppList",w="getRecommend",k="getNextAppList";function _(e){return{type:L,payload:e}}function C(e){return{type:w,payload:e}}function P(e){return{type:k,payload:e}}var S=function e(t){Object(i.a)(this,e),this.code=0,this.message="",this.raw="",Object.assign(this,t)};function A(e){var t=[].slice.call(arguments);t[0]={};var a,n,r,c=(a=Object.assign.apply(Object,t))?Object.keys(a).map(function(e){return e+"="+encodeURIComponent(a[e])}).join(n||"&"):"";return c?(r=/[\?&]$/.test(e)?"":~e.indexOf("?")?"&":"?",e+r+c):e}var R,T=function(e){var t={};return Object.keys(e).forEach(function(a){t[a]=function(t,n,r){var c=Object.assign({},e[a].data||{},t),s=e[a].url;s=s.replace(/\{{2}([^}]+?)\}{2}/,function(e,t){return c[t]});var i=Object.assign({method:e[a].method},e[a].options,n),o=Object.assign({},e[a].config,r);return console.log(e[a]),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{method:"get"},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r={mode:"cors"};return"get"===a.method.toLowerCase()?n.banQuery||(e=A(e,t)):r.body=JSON.stringify(t),Object.assign(r,a),new Promise(function(t,a){var n="";fetch(e,r).then(function(a){console.log("reqParam",e,r),a.ok?a.json().then(function(a){try{t([null,a])}catch(r){n="".concat(e," => parse response error: ")+a,t([new S({message:n,raw:r})])}}).catch(function(a){n="".concat(e," => Invalid json response: "),t([new S({message:n,raw:a})])}):(n="".concat(e," => Reqeust fail: ")+a.statusText,t([new S({message:n})]))}).catch(function(e){t([new S({message:n="network error",raw:e,code:-1})])})})}(s,c,i,o)}}),t}({appList:{url:"http://127.0.0.1:3010/appList",method:"get"},recommend:{url:"http://127.0.0.1:3010/recommend",method:"get"}}),M=67,I=document.compatMode&&"CSS1Compat"==document.compatMode?document.documentElement:document.body,J=I.clientHeight;var q=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).getNextPage=a.getNextPage.bind(Object(j.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;this.props.getAppList({limit:10},{success:function(){setTimeout(function(){t.getNextPage()})}}),this.props.getRecommend(),e=this.getNextPage,window.onscroll=function(){var t=I.scrollTop,a=I.offsetHeight-(t+J);console.log("3333",a,10*M),!R&&a<10*M&&(e&&e({success:function(){R=!1}}),R=!0)}}},{key:"getNextPage",value:function(e){var t=this.props.appList;t.hasNextPage&&this.props.getNextAppList({pageContext:t.pageContext},e)}},{key:"render",value:function(){var e=this.props,t=e.appList,a=e.recommend;return t||a?(console.log("aaaaaaaaaa",t,a),r.a.createElement("div",null,r.a.createElement(y,null),r.a.createElement(x,null),a?r.a.createElement(E,{recommend:a}):null,r.a.createElement("div",{className:"line_box"},r.a.createElement(x,null)),t?r.a.createElement(N,{appList:t}):null)):r.a.createElement(O,null)}}]),t}(n.PureComponent),D=Object(d.b)(function(e){return e},function(e){return{getAppList:function(){var t=Object(v.a)(f.a.mark(function t(a){var n,r,c,s,i,o,l=arguments;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},t.next=3,T.appList(a);case 3:r=t.sent,c=Object(g.a)(r,2),s=c[0],i=c[1],o=s||i,console.log("appList",i),e(_(o)),n.success&&n.success();case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getRecommend:function(){var t=Object(v.a)(f.a.mark(function t(a){var n,r,c,s,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.recommend(a);case 2:n=t.sent,r=Object(g.a)(n,2),c=r[0],s=r[1],i=c||s,console.log("recommend",s),e(C(i));case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getNextAppList:function(){var t=Object(v.a)(f.a.mark(function t(a){var n,r,c,s,i,o,l=arguments;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},t.next=3,T.appList(a);case 3:r=t.sent,c=Object(g.a)(r,2),s=c[0],i=c[1],o=s||i,console.log("getNextAppList",i),e(P(o)),n.success&&n.success();case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}})(q),H=a(29),B=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.resList;console.log("search_list",e);return r.a.createElement("div",{className:"search_list"},e.map(function(e,t){return r.a.createElement("div",{className:"search_item",key:t},r.a.createElement("div",{className:"name ellipsis"},e["im:name"].label),r.a.createElement("div",{className:"category ellipsis"},e.category.attributes.label),r.a.createElement("div",{className:"author ellipsis"},e["im:artist"].label),r.a.createElement("div",{className:"summary ellipsis"},e.summary.label))}))}}]),t}(n.PureComponent),Q=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={resList:"",keywords:""},a.onChange=a.onChange.bind(Object(j.a)(a)),a.getSmartList=a.getSmartList.bind(Object(j.a)(a)),a.goSearch=a.goSearch.bind(Object(j.a)(a)),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"onChange",value:function(e){var t=this,a=(e.persist(),e.target.value);this.setState({keywords:a}),clearTimeout(this.timer),this.timer=setTimeout(function(){a&&t.getSmartList(a)},300)}},{key:"getSmartList",value:function(e){console.log("keywords",e);var t=this.props,a=t.appList,n=t.recommend,r=new RegExp(e,"im"),c=[].concat(Object(H.a)(a.feed.entry),Object(H.a)(n.feed.entry)).filter(function(e){var t=e.category.attributes;return!!(r.test(t.label)||r.test(t.term)||r.test(e["im:artist"].label)||r.test(e["im:contentType"].attributes.label)||r.test(e["im:name"].label)||r.test(e.summary.label)||r.test(e.title.label))});return this.setState({resList:c}),c}},{key:"goSearch",value:function(){var e=this.getSmartList(this.state.keywords);this.setState({resList:e})}},{key:"render",value:function(){var e=this.props,t=(e.appList,e.recommend,this.state),a=t.resList,n=t.keywords;return r.a.createElement("div",{className:"input_box"},r.a.createElement("div",{className:"input_contaner"},r.a.createElement("input",{type:"text",value:n,placeholder:"\u641c\u7d22",onChange:this.onChange,id:"search_input"})),a?r.a.createElement(B,{resList:a}):null)}}]),t}(n.PureComponent),U=function(e){function t(e){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.getAppList({limit:100}),this.props.getRecommend()}},{key:"render",value:function(){var e=this.props,t=e.appList,a=e.recommend;return t||a?r.a.createElement("div",{className:"search_box"},t||a?r.a.createElement(Q,{appList:t,recommend:a}):null):r.a.createElement(O,null)}}]),t}(n.PureComponent),$=Object(d.b)(function(e){return e},function(e){return{getAppList:function(){var t=Object(v.a)(f.a.mark(function t(a){var n,r,c,s,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.appList(a);case 2:n=t.sent,r=Object(g.a)(n,2),c=r[0],s=r[1],i=c||s,console.log("appList",s),e(_(i));case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),getRecommend:function(){var t=Object(v.a)(f.a.mark(function t(a){var n,r,c,s,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.recommend(a);case 2:n=t.sent,r=Object(g.a)(n,2),c=r[0],s=r[1],i=c||s,console.log("recommend",s),e(C(i));case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}})(U),z=function(){return r.a.createElement(b.c,null,r.a.createElement(b.a,{exact:!0,path:"/",component:D}),r.a.createElement(b.a,{path:"/search",component:$}))},F=a(23),G={appList:"",recommend:""};var K=Object(F.b)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(console.log("reducer",t,e),t.type){case L:return Object.assign({},e,{appList:t.payload});case w:return Object.assign({},e,{recommend:t.payload});case k:return console.log("4444",e.appList.feed.entry,t.payload.feed.entry),t.payload.feed.entry=e.appList.feed.entry.concat(t.payload.feed.entry),console.log("4343434343434343434343",t.payload.feed.entry),Object.assign({},e,{appList:t.payload});default:return e}}),V=function(e){function t(){return Object(i.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app_box"},r.a.createElement(d.a,{store:K},r.a.createElement(p.a,null,z())))}}]),t}(n.PureComponent);s.a.render(r.a.createElement(V,null),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.f443a389.chunk.js.map